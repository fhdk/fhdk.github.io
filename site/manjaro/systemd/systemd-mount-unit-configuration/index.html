<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>systemd - mount units - Notes and Bookmarks</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "systemd - mount units";
        var mkdocs_page_input_path = "manjaro/systemd/systemd-mount-unit-configuration.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Notes and Bookmarks
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../about.md">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Bookmarks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../bookmarks/bookmark-linux-finding-port-origin/">Linux finding port origin</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Notes</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Dotnet</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/blazor-wasm-collapsible-sidebar/">Blazor WASM collapsible menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/blazor-wasm-pwa-service-worker/">Blazor WASM PWA service-worker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/csharp-api-response-custom-header/">Web API2 Expose Custom Header</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/dotnet-different-versions/">Different dotnet versions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/dotnet-notes-certificate/">Creating a dotnet development certificate</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >MacOS</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../macos/macos-create-installer-image/">macOS installer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Manjaro</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../ai/manjaro-folding-at-home/">Manjaro Folding@Home</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../android/android-manjaro-droid-cam/">Droid Cam on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../android/android-manjaro-iriun-webcam/">Iriun Web Cam on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cheats/cheatsheet-tmux/">tmux cheatsheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-alacritty-terminal-emulator/">Alacritty Terminal Emulator</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-change-username/">Change username</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-import-pfx-certificate/">Import pfx certificats on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-manjaro-tools-build-mirror/">Manjaro Tools build_mirror</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-x11-over-ssh/">X11 over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grub/grub-boot-iso-directly/">Boot ISO from GRUB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grub/grub-support-for-luks2-container/">Grub load system from luks2 container</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-cloud-instance-using-cloud-init/">Manjaro cloud instance using cloud-init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-kde-plasma/">CLI to LXDE</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-mate-systemd-boot-and-luks/">Mimick Manjaro Mate using sdboot and luks</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-on-a-stick/">Manjaro on a stick</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-and-luks/">Manjaro base using sdboot and luks</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-basic/">systemd-boot - BASIC - installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-luks-btrfs/">systemd-boot - LUKS - btrfs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-luks-ext4/">systemd-boot - LUKS - ext4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-using-luks/">Encrypted CLI installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-vanilla-gnome/">CLI to vanilla Gnome</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-persistent-usb-installation/">Manjaro Persistent USB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-usb-to-go-with-persistience/">USB LXDE with persistence</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../luks/luks-change-phrase/">Changing LUKS passphrase</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../luks/luks-dm-crypt-notes/">dm-crypt notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-00-about-manjaro-and-aur/">About Manjaro and AUR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-01-i-am-not-to-blame/">What is wrong - I am not to blame</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-02-responsible-use-of-aur/">Responsible use of AUR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-03-aur-restrain-yourself/">AUR - please restrain yourself</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-04-update-the-smart-way/">Update Manjaro the smart way</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-update-practise/">Smart Manjaro system update</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mirror/manjaro-offline-package-installation/">Manjaro - offline package installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mirror/manjaro-portable-mirror/">Portable Manjaro Mirror</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-basic-iptables-rules/">Basic firewall (iptables) rules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-basic-troubleshooting/">Network know-how</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-dns-using-bind-for-local-domain/">Using bind for local domain</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-share-peer-to-peer-connection/">Share network connection peer-to-peer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-tigervnc-over-ssh/">TigerVNC over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/networkmanager-disable-connectivity-check/">Disable NetworkManager connectivity check</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../nfs/nfs-file-sharing-manjaro/">Setting up NFS using Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../nfs/nfs-synology-nas/">Connect to Synology NFS share</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-arm-hacking-desktop-installer/">Hacking ARM desktop installer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-arm-hacking-installer-to-enable-wifi/">Hacking ARM install image to connect to WiFi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-be-compatible-with-vpn-providers/">Make Manjaro compatible with VPN providers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-convert-to-arch/">Convert Manjaro to Arch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-dual-boot-manjaro-and-windows/">Dual boot Manjaro and Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-dual-boot-windows/">Linux dual-boot Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-iso-to-usb-no-wasted-space/">ISO to USB no wasted space</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-iso-tty-autologin/">Automated ISO login</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-reinstall-withoug-losing-data/">Reinstall Manjaro without loosing data</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-run-java-application/">Run a Java program on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-simple-nas-configuration/">Manjaro NAS (network attached storage)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/share-data-in-multi-boot-environment/">Sharing data in multi-boot environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/share-data-in-multiuser-environment/">Sharing data in multiuser environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/ssh-secure-your-ssh-service/">SSH server security</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/thunar-custom-actions/">Thunar custom actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pine64/pinebook-pro-network-wifi-privacy-cycle/">Pinebook Pro Network Wifi Privacy Cycle</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pine64/pinephone-community-edition/">Pine Phone Community Edition</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-install-nextcloud/">Install NextCloud on Raspberry Pi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-notes/">Raspberry Pi notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-selfhosted-nextcloud/">Sharing Pi NextClound</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-ubuntu-server/">Ubuntu Server on RPi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-vnc-over-ssh/">Raspberry Pi VNC over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-zero-w-prepare-wireless-connection/">Pi Zero W - prepare wireless connection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-arm-wireless-file-service/">ARM wireless Samba file service based on Arch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-basic-setup-and-troubleshooting/">Basic Samba Setup and Troubleshooting</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-from-scratch/">Samba From Scratch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-minimal-configuration/">Minimal SMB configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-protocols-overview/">SMB protocols overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-quick-setup-public-read-write-shares/">Samba Quick Setup public read-write shares</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-arm-image-wifi-hack/">Arch ARM image WiFi hack</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-battery-charge-notifier/">Battery Charge Notifier</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-check-aur-buildscript-changes/">Check AUR buildscript changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-check-if-update-may-require-reboot/">Kontroller om genstart er nødvendig før du opdaterer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-get-lan-ip-address/">Get LAN IP address</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-mount-samba-share-as-user/">Mount samba share as user</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-package-and-configuration-backup/">Packagelist and Configuration backup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-set-default-browser/">Set Browser Script</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-template-freerdp/">Get LAN IP address</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-usb-partion-format/">USB partition script</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../secure-boot/secure-boot-manjaro-using-repo-only/">Manjaro and Windows - Secure Boot - repo only</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">systemd - mount units</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-ftp-sample/">FTP mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-nfs-sample/">NFS mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-partition-sample/">Partition mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-removable-sample/">USB device</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-samba-sample/">SMB mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-mount-unit-webdav-sample/">WEBDAV mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../systemd-unit-documentation/">Systemd unit manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-boot-to-shell/">kernel init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-locale-error-messages/">Locale error messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-makepkg-missing-gpg-keys/">Retrieve missing GPG using makepkg</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-manjaro-windows-dual-boot/">Troubleshooting Manjaro Windows dual-boot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-system-missing-firmware/">Troubleshooting missing firmware access</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-using-reisub/">REISUB / REISUO</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../virtual/libvirt-install-windows-11/">virt-manager - Windows 11</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../virtual/virtualbox-headless-windows/">Headless Windows on VirtualBox</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >MS-Windows</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-avoid-ms-account-on-installation/">Install with local account</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-create-a-windows-usb/">Create a Windows USB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-killing-process/">Killing process in MS Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-visual-studio-iis-express-configuration/">Visual Studio IISExpress</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Notes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/essay-linux-is-not-windows/">Linux is Not Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/essay-the-perfext-linux-os/">The perfect Linux OS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/md-raid-notes/">MD/RAID notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-disk-using-fstab/">Permanent mounts using fstab</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-loop-img-files/">CLI mount .img files on Arch based system</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-storage-partition-mount-using-fstab/">Store personal files using separate partition (fstab)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-storage-partition-mount-using-systemd/">Store personal files using separate partition (systemd)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-windows-partition/">Access my second harddrive</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mouse-and-keyboard-sharing/">Mouse and keyboard sharing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/ms-sql-notes/">Contraints</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/powershell-sql-queries/">Using Powershell for SQL queries</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/systemd-boot-notes/">Notes on systemd-boot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/tools-linux-recovery-tools-and-iso/">Tools Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/ubiquiti-flash-usg-3p/">Flash USG-3P</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/usb-clearing-a-stubborn-device/">Clearing a stubborn storage device</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/xorg-intel-x11-config/">Intel Xorg config</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Notes and Bookmarks</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Notes</li>
          <li class="breadcrumb-item">Manjaro</li>
      <li class="breadcrumb-item active">systemd - mount units</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="disk-device-recognition">Disk device recognition</h2>
<p>Arch uses systemd and udev (see <a href="https://wiki.archlinux.org/index.php/Udev">Arch Wiki</a>) to load devices at boot time. The loading order of devices is arbitrary and therefore you cannot predict which device will be available at a given path.</p>
<p>But as explained on the Arch wiki <a href="https://wiki.archlinux.org/index.php/Udev#Setting_static_device_names">static device names</a> do exist and so you can assign specific mountpoint(s) to your device(s) and thus ensure e.g. scripts will work as expected.</p>
<h2 id="what-to-learn">What to learn</h2>
<ol>
<li>Overview of system mount units</li>
<li>Structure and Content of a mount unit</li>
<li>Mount at boot (immediate mount)</li>
<li>Mount at demand (mount on first access)</li>
<li>Conclusion</li>
</ol>
<h2 id="1-what-is-systemd-mount-units">1. What is systemd mount units</h2>
<hr />
<p>The systemd manual has the following somewhat contradicting statement</p>
<blockquote>
<p>Mount units may either be configured via unit files, or via /etc/fstab (see <a href="http://man7.org/linux/man-pages/man5/fstab.5.html">fstab(5)</a> for details). <strong><em>Mounts listed in /etc/fstab will be converted into native units dynamically at boot</em></strong> and when the configuration of the system manager is reloaded. In general, <strong><em>configuring mount points through /etc/fstab is the preferred approach</em></strong>. See <a href="http://man7.org/linux/man-pages/man8/systemd-fstab-generator.8.html">systemd-fstab-generator(8)</a> for details about the conversion.- <a href="http://man7.org/linux/man-pages/man5/systemd.mount.5.html#FSTAB">system.d.mount.5.html#FSTAB</a> (Emphasized by me)</p>
</blockquote>
<h3 id="logic">Logic</h3>
<p>As mounts listed in fstab <strong><em>will be converted into native units dynamically at boot</em></strong> - logically we create the units ahead so the system don't have to bother with converting fstab - the contradiction in above statement is <strong><em>fstab is the preferred approach</em></strong>. </p>
<p><strong>What?</strong>  Why would would it be preferable to use a configuration which must be parsed and converted when you can create native units?</p>
<p><strong>I use mount units because</strong>
* They are easy to create
* They provide clear logic of
   - What
   - Where
   - When
   - Why
   - How
* Simple auto mount defines</p>
<h3 id="_1"></h3>
<p>Using automount units to mount a device using systemd is a simple secure approach. </p>
<p>The top arguments for using mount units</p>
<ul>
<li>you don't have to edit your fstab</li>
<li>you don't have to create the mountpoint(s) beforehand</li>
<li>you have a clear overview - which you will se later</li>
</ul>
<p>This article will use an USB device which may or may not be available at boot time and when you plug it you want it to be mounted on a special path - it could be dedicated backup disk.</p>
<p>The basics of this guide can also be used to mount any extra devices available in your system, or remote shares e.g. WEBDAV, SMB, FTP and NFS. You can find link to a topic containing sample mount units at the end of this article.</p>
<h2 id="2-structure-and-content-of-a-mount-unit">2. Structure and Content of a mount unit</h2>
<hr />
<p>There is no rules as to where you can mount the device. Just remember a few things</p>
<ul>
<li>Structure</li>
<li>Recognizable</li>
<li>Don't use <strong>/run</strong> is a volatile structure recreated at boot</li>
<li>Don't use <strong>/mnt</strong> it's primary use is temporary mount</li>
</ul>
<p>By structure I mean organizing a directory tree - I usually recommend create a data folder on root and populate the tree with your devices and locations like below.</p>
<p>By recognizable I mean naming your mount point with a logical description of the content - but <strong>don't use dashes anywhere in the mount point</strong> - see explanation below. If you really need a double word in your data tree - use a low dash  ( <strong>_</strong> ). You should also avoid local accented characters (e.g. danish æ ø å Æ Ø Å)</p>
<p>Immediate branches are your devices - and network share mounts in a branch named for the type of fileservice e.g. NFS and SMB.</p>
<pre><code>$ tree /data -L 2
/data
├── backup
├── build
├── nfs
│   ├── data
│   ├── music
│   ├── photo
│   ├── video
│   └── web
├── private
├── projects
├── smb
│   └── web
└── virtualbox
</code></pre>
<p>Naming the mount units uses a mandatory convention.</p>
<p>Lets say you have a disk for backup and the disk mounts to <strong>/data/backup</strong> then the filename becomes.</p>
<ul>
<li><strong>data-backup.mount</strong></li>
</ul>
<p><strong>NOTE :</strong> Dashes in the file name represents the directory separator - so <strong>don't use dashes anywhere in the mount point</strong>. </p>
<p>Create a file as root</p>
<pre><code class="language-bash">$ sudo touch /etc/systemd/system/data-backup.mount
</code></pre>
<p>Open the file with your favorite CLI editor or a gvfs compliant editor (xed or gedit)</p>
<pre><code class="language-bash">$ xed admin:/etc/systemd/system/data-backup.mount
</code></pre>
<h3 id="template">Template</h3>
<p>Insert the following template into the file - and modify the description - continuing our backup disk example</p>
<pre><code class="language-text">[Unit]
Description=Mount Backup disk (/data/backup)

[Mount]
What=
Where=
#Type=
#Options=
#TimeoutSec=seconds

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="mount">Mount</h3>
<p>The section <strong>[Mount]</strong> is the same data as you see in your fstab - except the <strong>What</strong> which must the full path to the device. The nature of systemd makes it impossible to rely on the traditional path <strong>/dev/sda1</strong> - so we will use <strong>/dev/disk/by-uuid/</strong>.</p>
<h3 id="what">What</h3>
<p>To get the device uuid you can use <strong>lsblk</strong> command and the <strong>-no UUID</strong> to retrieve the uuid you need for the mount. (substitute sdy1 with your actual device and partition)</p>
<pre><code class="language-bash">$ lsblk -no UUID /dev/sdy1
67f922cd-a61f-4d5e-84c0-ac8335a7ce67
</code></pre>
<p>Then insert the UUID into the file</p>
<pre><code class="language-text">What=/dev/disk/by-uuid/67f922cd-a61f-4d5e-84c0-ac8335a7ce67
</code></pre>
<h3 id="where">Where</h3>
<p>Next type in the path where you want the device mounted. Normally we would create the path beforehand as this is required for fstab - but not with systemd. If the path do not exist it will be created.</p>
<p>:information_source: default permissions is 755 owned by root</p>
<p>If your actual device is an existing device <strong>and</strong> the owner:group UID:GID do not match your device will be mounted read-only.</p>
<pre><code class="language-text">Where=/data/backup
</code></pre>
<p><strong>Caveat using dashes in a folder-name</strong>
Don't use a dash <strong>-</strong> in your path because a dash refer to a new branch on the folder tree and this will break the naming of the mount/automount file</p>
<ul>
<li>Invalid <strong>/data/home-backup</strong></li>
<li>Valid <strong>/data/home_backup</strong></li>
<li>Valid <strong>/data/home\x2dbackup</strong></li>
</ul>
<p>To get the correct name for your mount/automount filename when you use dashes in your folder-naming</p>
<pre><code class="language-bash">$ systemd-escape -p --suffix=mount &quot;/data/home-backup&quot;
data/home\x2dbackup.mount
</code></pre>
<h3 id="type">Type</h3>
<p>The <strong>Type</strong> is optional for disk devices - but from the viewpoint - the more information we provide - less work for the system. </p>
<p>You can retrieve the file system the same way as the UUID.</p>
<pre><code>$ lsblk -no FSTYPE /dev/sdy1
ext4
</code></pre>
<p>Insert the filesystem type</p>
<pre><code class="language-text">Type=ext4
</code></pre>
<p>Other types like NFS, SMB and FTP requires <strong>Type</strong> to be set.</p>
<h3 id="options">Options</h3>
<p>The <strong>Options</strong> is optional for disk devices. </p>
<p>As with fstab it takes a comma separated list of options for the filesystem mounted. </p>
<p>Other types like NFS, SMB and FTP requires <strong>Options</strong> to be set.</p>
<pre><code class="language-text">Options=defaults,rw,noatime
</code></pre>
<p>Save the file</p>
<h2 id="3-mount-on-boot">3. Mount on boot</h2>
<hr />
<p>This works just like your fstab - if the device is not available - the system will use the default 90 seconds for the device to be available. The behavior can be changed by setting <strong>TimeoutSec=</strong> to a value matching the device actual mount time or use an additional automount unit.</p>
<p>First reload the systemd daemon</p>
<pre><code class="language-bash">$ sudo systemctl daemon-reload
</code></pre>
<p>Note the state of the mount</p>
<pre><code class="language-bash">$ systemctl show -p ActiveState -p SubState --value data-backup.mount
</code></pre>
<p>Mount the device</p>
<pre><code class="language-bash">$ sudo systemctl start data-backup.mount
</code></pre>
<p>Now you can verify the service</p>
<pre><code class="language-bash">$ systemctl show -p ActiveState -p SubState --value data-backup.mount
</code></pre>
<p>Note that the folder was created by systemd - list the content of the mount
<strong>NOTE:</strong> note permissions changed to partition content</p>
<pre><code class="language-bash">$ ls -la /data/backup
</code></pre>
<p>If the device is an internal device always available you can enable the mount and your device will be mounted during boot.</p>
<pre><code>sudo systemctl enable data-backup.mount
</code></pre>
<p>If - on the other hand - this is an USB device - which is not available at boot time - do not enable the the mount unit but proceed to create an <code>.automount</code> unit for your USB device.</p>
<h3 id="check-permissions">Check permissions</h3>
<p>If this is a newly formatted device or a reused device - it is wise to check the permissions. If you get issues with the device being mounted read-only - depending on filesystem - it may be due to the permissions stored on the device.</p>
<p>If the device is using a Linux file system you can change permissions when it is mounted. To change the permissions on your games partition mounted at <strong><code>/data/games</code></strong></p>
<pre><code>sudo chmod ugo+rw /data/games -R
</code></pre>
<p>If your device is a shared device dual booting Windows and Linux and formatted using NTFS and it mounts read-only - reboot your system into Windows and disable features like Fastboot, hibernation, sleep and hybrid sleep as these will taint the filesystem and cause Linux to mount it read-only.</p>
<h2 id="4-mount-on-demand">4. Mount on demand</h2>
<hr />
<p>An automount unit is a special unit which takes care of activating the corresponding mount unit when the mount path is accessed. The difference for mount and automount is <strong>when</strong> it is mounted.</p>
<p>To demonstrate the automount - first unmount the data-mount</p>
<pre><code class="language-bash">$ sudo systemctl stop data-backup.mount
</code></pre>
<p>Verify  the content of the mount point - it should now be empty.</p>
<pre><code class="language-bash">$ ls -la /data/backup
</code></pre>
<p>Now we proceed to create an automount for the mount. Create a file - it must be named using the same rule as the mount but with the extension of <strong>.automount</strong></p>
<pre><code class="language-bash">$ sudo touch /etc/systemd/system/data-backup.automount
</code></pre>
<p><strong>NOTE:</strong> the automount service will fail if the device path is mounted</p>
<h3 id="automount-define">Automount define</h3>
<p>Edit the file and insert the following content and save it.</p>
<pre><code class="language-text">[Unit]
Description=Automount backup partition

[Automount]
Where=/data/backup
TimeoutIdleSec=10

[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="test-automount">Test automount</h3>
<hr />
<p>Now enable and start the automount for data-backup</p>
<pre><code class="language-bash">$ sudo systemctl enable --now data-backup.automount
</code></pre>
<p>You know you unmounted the device - don't mount it - just access the <strong>/data/backup</strong> folder from terminal or a file manager - you will find systemd mounts it behind the scenes.</p>
<h2 id="5-conclusion">5. Conclusion</h2>
<hr />
<p>This approach is a safer way than editing your fstab. Worst case the device is not mounted - if you make a mistake in fstab - the system breaks.</p>
<p>You can mount all kind of devices - NFS, SMB, FTP, WEBDAV, SFTP, SSH - using this recipe.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../secure-boot/secure-boot-manjaro-using-repo-only/" class="btn btn-neutral float-left" title="Manjaro and Windows - Secure Boot - repo only"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../systemd-mount-unit-ftp-sample/" class="btn btn-neutral float-right" title="FTP mount unit">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../secure-boot/secure-boot-manjaro-using-repo-only/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../systemd-mount-unit-ftp-sample/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
