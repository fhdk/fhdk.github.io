<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Manjaro and Windows - Secure Boot - repo only - Notes and Bookmarks</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Manjaro and Windows - Secure Boot - repo only";
        var mkdocs_page_input_path = "manjaro/secure-boot/secure-boot-manjaro-using-repo-only.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Notes and Bookmarks
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../../about.md">About</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Bookmarks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../bookmarks/bookmark-linux-finding-port-origin/">Linux finding port origin</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Notes</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" >Dotnet</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/blazor-wasm-collapsible-sidebar/">Blazor WASM collapsible menu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/blazor-wasm-pwa-service-worker/">Blazor WASM PWA service-worker</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/csharp-api-response-custom-header/">Web API2 Expose Custom Header</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/dotnet-different-versions/">Different dotnet versions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../dotnet/dotnet-notes-certificate/">Creating a dotnet development certificate</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >MacOS</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../macos/macos-create-installer-image/">macOS installer</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Manjaro</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../../ai/manjaro-folding-at-home/">Manjaro Folding@Home</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../android/android-manjaro-droid-cam/">Droid Cam on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../android/android-manjaro-iriun-webcam/">Iriun Web Cam on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cheats/cheatsheet-tmux/">tmux cheatsheet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-alacritty-terminal-emulator/">Alacritty Terminal Emulator</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-change-username/">Change username</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-import-pfx-certificate/">Import pfx certificats on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-manjaro-tools-build-mirror/">Manjaro Tools build_mirror</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../configuration/configuration-x11-over-ssh/">X11 over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grub/grub-boot-iso-directly/">Boot ISO from GRUB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../grub/grub-support-for-luks2-container/">Grub load system from luks2 container</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-cloud-instance-using-cloud-init/">Manjaro cloud instance using cloud-init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-kde-plasma/">CLI to LXDE</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-mate-systemd-boot-and-luks/">Mimick Manjaro Mate using sdboot and luks</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-on-a-stick/">Manjaro on a stick</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-and-luks/">Manjaro base using sdboot and luks</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-basic/">systemd-boot - BASIC - installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-luks-btrfs/">systemd-boot - LUKS - btrfs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-systemd-boot-luks-ext4/">systemd-boot - LUKS - ext4</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-using-luks/">Encrypted CLI installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-cli-installation-vanilla-gnome/">CLI to vanilla Gnome</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-persistent-usb-installation/">Manjaro Persistent USB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/manjaro-usb-to-go-with-persistience/">USB LXDE with persistence</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../luks/luks-change-phrase/">Changing LUKS passphrase</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../luks/luks-dm-crypt-notes/">dm-crypt notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-00-about-manjaro-and-aur/">About Manjaro and AUR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-01-i-am-not-to-blame/">What is wrong - I am not to blame</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-02-responsible-use-of-aur/">Responsible use of AUR</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-03-aur-restrain-yourself/">AUR - please restrain yourself</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-maintenance-04-update-the-smart-way/">Update Manjaro the smart way</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../maintenance/manjaro-update-practise/">Smart Manjaro system update</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mirror/manjaro-offline-package-installation/">Manjaro - offline package installation</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../mirror/manjaro-portable-mirror/">Portable Manjaro Mirror</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-basic-iptables-rules/">Basic firewall (iptables) rules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-basic-troubleshooting/">Network know-how</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-dns-using-bind-for-local-domain/">Using bind for local domain</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-share-peer-to-peer-connection/">Share network connection peer-to-peer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/network-tigervnc-over-ssh/">TigerVNC over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../network/networkmanager-disable-connectivity-check/">Disable NetworkManager connectivity check</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../nfs/nfs-file-sharing-manjaro/">Setting up NFS using Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../nfs/nfs-synology-nas/">Connect to Synology NFS share</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-arm-hacking-desktop-installer/">Hacking ARM desktop installer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-arm-hacking-installer-to-enable-wifi/">Hacking ARM install image to connect to WiFi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-be-compatible-with-vpn-providers/">Make Manjaro compatible with VPN providers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-convert-to-arch/">Convert Manjaro to Arch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-dual-boot-manjaro-and-windows/">Dual boot Manjaro and Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-dual-boot-windows/">Linux dual-boot Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-iso-to-usb-no-wasted-space/">ISO to USB no wasted space</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-iso-tty-autologin/">Automated ISO login</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-reinstall-withoug-losing-data/">Reinstall Manjaro without loosing data</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-run-java-application/">Run a Java program on Manjaro</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/manjaro-simple-nas-configuration/">Manjaro NAS (network attached storage)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/share-data-in-multi-boot-environment/">Sharing data in multi-boot environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/share-data-in-multiuser-environment/">Sharing data in multiuser environment</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/ssh-secure-your-ssh-service/">SSH server security</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../notes/thunar-custom-actions/">Thunar custom actions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pine64/pinebook-pro-network-wifi-privacy-cycle/">Pinebook Pro Network Wifi Privacy Cycle</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../pine64/pinephone-community-edition/">Pine Phone Community Edition</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-install-nextcloud/">Install NextCloud on Raspberry Pi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-notes/">Raspberry Pi notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-selfhosted-nextcloud/">Sharing Pi NextClound</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-ubuntu-server/">Ubuntu Server on RPi</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-vnc-over-ssh/">Raspberry Pi VNC over SSH</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../raspberry-pi/raspberry-pi-zero-w-prepare-wireless-connection/">Pi Zero W - prepare wireless connection</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-arm-wireless-file-service/">ARM wireless Samba file service based on Arch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-basic-setup-and-troubleshooting/">Basic Samba Setup and Troubleshooting</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-from-scratch/">Samba From Scratch</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-minimal-configuration/">Minimal SMB configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-protocols-overview/">SMB protocols overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../samba/samba-quick-setup-public-read-write-shares/">Samba Quick Setup public read-write shares</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-arm-image-wifi-hack/">Arch ARM image WiFi hack</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-battery-charge-notifier/">Battery Charge Notifier</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-check-aur-buildscript-changes/">Check AUR buildscript changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-check-if-update-may-require-reboot/">Kontroller om genstart er nødvendig før du opdaterer</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-get-lan-ip-address/">Get LAN IP address</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-mount-samba-share-as-user/">Mount samba share as user</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-package-and-configuration-backup/">Packagelist and Configuration backup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-set-default-browser/">Set Browser Script</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-template-freerdp/">Get LAN IP address</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../scripts/script-usb-partion-format/">USB partition script</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Manjaro and Windows - Secure Boot - repo only</a>
    <ul class="current">
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-configuration/">systemd - mount units</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-ftp-sample/">FTP mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-nfs-sample/">NFS mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-partition-sample/">Partition mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-removable-sample/">USB device</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-samba-sample/">SMB mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-mount-unit-webdav-sample/">WEBDAV mount unit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../systemd/systemd-unit-documentation/">Systemd unit manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-boot-to-shell/">kernel init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-locale-error-messages/">Locale error messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-makepkg-missing-gpg-keys/">Retrieve missing GPG using makepkg</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-manjaro-windows-dual-boot/">Troubleshooting Manjaro Windows dual-boot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-system-missing-firmware/">Troubleshooting missing firmware access</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/troubleshoot-using-reisub/">REISUB / REISUO</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../virtual/libvirt-install-windows-11/">virt-manager - Windows 11</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../virtual/virtualbox-headless-windows/">Headless Windows on VirtualBox</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >MS-Windows</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-avoid-ms-account-on-installation/">Install with local account</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-create-a-windows-usb/">Create a Windows USB</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-killing-process/">Killing process in MS Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../ms-windows/ms-windows-visual-studio-iis-express-configuration/">Visual Studio IISExpress</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Notes</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/essay-linux-is-not-windows/">Linux is Not Windows</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/essay-the-perfext-linux-os/">The perfect Linux OS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/md-raid-notes/">MD/RAID notes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-disk-using-fstab/">Permanent mounts using fstab</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-loop-img-files/">CLI mount .img files on Arch based system</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-storage-partition-mount-using-fstab/">Store personal files using separate partition (fstab)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-storage-partition-mount-using-systemd/">Store personal files using separate partition (systemd)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mount-windows-partition/">Access my second harddrive</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/mouse-and-keyboard-sharing/">Mouse and keyboard sharing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/ms-sql-notes/">Contraints</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/powershell-sql-queries/">Using Powershell for SQL queries</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/systemd-boot-notes/">Notes on systemd-boot</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/tools-linux-recovery-tools-and-iso/">Tools Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/ubiquiti-flash-usg-3p/">Flash USG-3P</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/usb-clearing-a-stubborn-device/">Clearing a stubborn storage device</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../../notes/xorg-intel-x11-config/">Intel Xorg config</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Notes and Bookmarks</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Notes</li>
          <li class="breadcrumb-item">Manjaro</li>
      <li class="breadcrumb-item active">Manjaro and Windows - Secure Boot - repo only</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="about-secure-boot">About Secure Boot</h2>
<ul>
<li>Secure Boot is a mechanism for verifying operating system integrity</li>
<li>The mechanism was pionereed by Microsoft and is now a defacto standard</li>
<li>Configuring Secure Boot requires access to the system's firmware</li>
<li>The firmware access requirement prevent OOB support of Secure Boot</li>
</ul>
<h2 id="background">Background</h2>
<p>This How-To is based on the question asked with <a href="https://forum.manjaro.org/t/enable-secure-boot-for-existing-manjaro-using-repo-only/174514">Enable Secure Boot For Existing Manjaro Usung Repo Only</a> and can be seen as a complement to <a href="https://forum.manjaro.org/t/root-tip-utility-script-encrypted-manjaro-linux-using-verified-boot/155032">Encrypted Manjaro Linux Using Verified Boot</a>.</p>
<p>I decided to work on the theory - and brush up on new sbctl options and configuration.</p>
<p>To be able to comply with corporate security - this is a proof-of-concept - how to make Manjaro and Windows co-exist with Secure Boot enabled.</p>
<h2 id="precaution">Precaution</h2>
<p>Make sure your system’s firmware is up-to-date - if in doubt check with the vendor’s website.</p>
<p>Your system may require a signed driver blob stored in the firmware - in such case contact your vendor through their official support channels - and verify if you void your warranty or brick your system.</p>
<p><strong>You are the system admin</strong></p>
<blockquote>
<p>THE PROOF OF CONCEPT IS PROVIDED “AS IS” AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS DOCUMENT INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OF THIS PROOF OF CONCEPT.</p>
</blockquote>
<h2 id="target-system">Target System</h2>
<p>The test system is Clevo N141wu with a single NVMe storage device and the steps I am going to list works with the mentioned laptop.</p>
<p>I downloaded and installed a Windows 10 - and subsequently added Manjaro using GRUB for dual-boot using a single Linux 6.12 kernel.</p>
<p>Although this project did not test Windows 11, there is no reason to believe the process would be any different than the one applied herein.</p>
<p>If you are trying to implement this with another layout - you must adapt the process.</p>
<p>Other systems tested (removed existing key database)</p>
<ul>
<li>Thinkpad X13 AMD Gen.4</li>
<li>Tuxedo InfinitiBookPro 14 Gen.8</li>
</ul>
<h2 id="proof-of-concept">Proof of Concept</h2>
<p>This is a practical implementation using <strong>sbctl</strong> on Manjaro Linux.</p>
<p>See -&gt; https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Assisted_process_with_sbctl</p>
<p>The PoC assumes the system has been kept up-to-date both operating systems.</p>
<p>Sync the package sbctl from the official repo</p>
<pre><code>sudo pacman -S sbctl
</code></pre>
<p>After this you have an excellent opportunity to familiarize yourself with <strong>sbctl</strong> usage</p>
<pre><code class="language-text">sbctl --help
sbctl bundle --help
sbctl create-keys --help
sbctl enroll-keys --help
sbctl generate-bundles --help
</code></pre>
<h3 id="kernel-cmdline">Kernel Cmdline</h3>
<p>Extract the <em>GRUB_CMDLINE_LINUX_DEFAULT</em> from <code>/etc/default/grub</code> and save the content in a <strong>new file <code>/etc/kernel/cmdline</code></strong>. The content - using a default Manjaro installation - would look like</p>
<pre><code>root=UUID=&lt;uuid&gt; rw quiet splash apparmor=1 security=apparmor udev.log_priority=3
</code></pre>
<p>When you created the file - create a new bundle using <strong>sbctl</strong>. </p>
<h3 id="define-bundle">Define Bundle</h3>
<p>A bundle is the set of files used to start your system.</p>
<p>To create a bundle definition you run <strong><code>sbctl bundle &lt;args&gt;</code></strong> providing the mountpoint of the $esp, paths to the files to bundle and full path to the unified efi loader.</p>
<ul>
<li><code>--amducode '/boot/amd-ucode.img'</code> includes ucode for AMD</li>
<li><code>--intelucode  '/boot/intel-ucode.img'</code>includes ucode for Intel</li>
</ul>
<p>Example for an AMD system</p>
<pre><code>sudo sbctl bundle --esp '/boot/efi' \
                  --amducode '/boot/amd-ucode.img' \
                  --cmdline '/etc/kernel/cmdline' \
                  --initramfs '/boot/initramfs-6.12-x86_64.img' \
                  --kernel-img '/boot/vmlinuz-6.12-x86_64' \
                  --save '/boot/efi/main.efi'
</code></pre>
<p>As can be deduced - it is fairly easy to create extra bundles with e.g. a fallback image - <strong>just don't do it</strong> (See Storage Consideration below).</p>
<h3 id="create-signing-keys">Create Signing Keys</h3>
<p>A key is required to sign the bundle - so create the key</p>
<pre><code>sudo sbctl create-keys
</code></pre>
<h3 id="generate-bundle-and-sign">Generate Bundle and Sign</h3>
<p>When you have created the keys - generate the bundle and sign</p>
<pre><code>sudo sbctl generate-bundles --sign
</code></pre>
<h3 id="configure-setup-mode">Configure Setup Mode</h3>
<p>Restart your system and enter the firmware setup</p>
<pre><code>systemctl reboot --firmware-setup
</code></pre>
<p>In the system firmware you need to locate the <strong>Secure Boot</strong> section, then configure Secure Boot for <strong>Setup Mode</strong>. </p>
<p>How you do this is specific for your firmware - you may need to experiment.</p>
<h3 id="enroll-keys">Enroll Keys</h3>
<p>When you are confident the system's Secure Boot is in Setup Mode, boot into your Manjaro system - and enroll your key into Secure Boot key storage, remember to include Microsoft keys</p>
<pre><code>sudo sbctl enroll-keys --microsoft
</code></pre>
<p>The command ensures the firmware Setup Mode is reverted to production mode. It is not automagically protected - for that you need to set an administrative password.</p>
<h2 id="firmware-boot-entry">Firmware boot entry</h2>
<p>To be able to use your firmware's boot override it is necesary to create a firmware boot entry. For our PoC the command look like this</p>
<p>To avoid confusing the default Manjaro entry; label the entry <strong>Manjaro Verified Boot</strong></p>
<pre><code>sudo efibootmgr  --loader main.efi --create --disk /dev/nvme0n1 --part 1 --label 'Manjaro Verified Boot' --unicode
</code></pre>
<h2 id="storage-consideration">Storage Consideration</h2>
<p>The $esp (efi system partition) with default Microsoft Windows 10 installation is 100M, and this is leaving little room to wiggle, as a single efi image takes 42M, thus leaving 29M remaining space.</p>
<pre><code class="language-text">[nix-n14xwu ~]# ls -l -h /boot/efi
total 42M
drwx------ 5 root root 1,0K 21 feb 12:59  EFI
drwx------ 2 root root 1,0K 21 feb 13:35  loader
-rwx------ 1 root root  42M 21 feb 12:42  main.efi
drwx------ 2 root root 1,0K 21 feb 11:37 'System Volume Information'
</code></pre>
<h2 id="maintenance">Maintenance</h2>
<p>The bundle is a static configuration - it will not change automagically - e.g. triggered by a hook.</p>
<p>The kernel maintenance within a release e.g. 6.12 is not an issue as the name has not changed.</p>
<p>When you decide to switch kernel e.g. from 6.12 to 6.14 - the name changes and you need to maintain your bundle.</p>
<h3 id="generate-new-bundle">Generate new Bundle</h3>
<p>This can be done by recreating your bundle configuration using <strong>sbctl</strong></p>
<pre><code>sudo sbctl bundle --esp '/boot/efi' \
                  --amducode '/boot/amd-ucode.img' \
                  --cmdline '/etc/kernel/cmdline' \
                  --initramfs '/boot/initramfs-6.14-x86_64.img' \
                  --kernel-img '/boot/vmlinuz-6.14-x86_64' \
                  --save '/boot/efi/main.efi'
</code></pre>
<h3 id="manually-update-bundle">Manually update bundle</h3>
<p>The bundle configuration is stored in <code>/var/lib/sbctl/bundles.json</code> so you can manually change the filenames but then you have no error checking if you misspell a filename - thus it is not recommended - instead use the bundle command.</p>
<h3 id="generate-bundle">Generate bundle</h3>
<p>Generate the bundle and sign it</p>
<pre><code>sudo sbctl generate-bundles --sign
</code></pre>
<h2 id="protect-your-firmware">Protect Your Firmware</h2>
<p>It is strongly suggested to lock your computers firmware with an administrative password - otherwise it is easy to circumvent the boot measures applied.</p>
<p>The firmware will now be enabled and your system may now be compliant with your corporate policies stating Secure Boot must be enabled.</p>
<p>Before you rejoice too much - ask your Corporate IT department.</p>
<h2 id="about-secure-boot_1">About Secure Boot</h2>
<ul>
<li>Secure Boot is a mechanism for verifying operating system integrity</li>
<li>The mechanism was pionereed by Microsoft and is now a defacto standard</li>
<li>Configuring Secure Boot requires access to the system's firmware</li>
<li>The firmware access requirement prevent OOB support of Secure Boot</li>
</ul>
<h2 id="background_1">Background</h2>
<p>This How-To is based on the question asked with <a href="https://forum.manjaro.org/t/enable-secure-boot-for-existing-manjaro-using-repo-only/174514">Enable Secure Boot For Existing Manjaro Usung Repo Only</a> and can be seen as a complement to <a href="https://forum.manjaro.org/t/root-tip-utility-script-encrypted-manjaro-linux-using-verified-boot/155032">Encrypted Manjaro Linux Using Verified Boot</a>.</p>
<p>I decided to work on the theory - and brush up on new sbctl options and configuration.</p>
<p>To be able to comply with corporate security - this is a proof-of-concept - how to make Manjaro and Windows co-exist with Secure Boot enabled.</p>
<h2 id="target-system_1">Target System</h2>
<p>The test system is Clevo N141wu with a single NVMe storage device and the steps I am going to list works with the mentioned laptop.</p>
<p>I downloaded and installed a Windows 10 - and subsequently added Manjaro using GRUB for dual-boot using a single Linux 6.12 kernel.</p>
<p>Although this project did not test Windows 11, there is no reason to believe the process would be any different than the one applied herein.</p>
<p>If you are trying to implement this with another layout - you must adapt the process.</p>
<h2 id="proof-of-concept_1">Proof of Concept</h2>
<p>This is a practical implementation using <strong>sbctl</strong> on Manjaro Linux.</p>
<p>See -&gt; https://wiki.archlinux.org/title/Unified_Extensible_Firmware_Interface/Secure_Boot#Assisted_process_with_sbctl</p>
<p>The PoC assumes the system has been kept up-to-date both operating systems.</p>
<p>Sync the package sbctl from the official repo</p>
<pre><code>sudo pacman -S sbctl
</code></pre>
<p>After this you have an excellent opportunity to familiarize yourself with <strong>sbctl</strong> usage</p>
<pre><code class="language-text">sbctl --help
sbctl bundle --help
sbctl create-keys --help
sbctl enroll-keys --help
sbctl generate-bundles --help
</code></pre>
<h3 id="kernel-cmdline_1">Kernel Cmdline</h3>
<p>Extract the <em>GRUB_CMDLINE_LINUX_DEFAULT</em> from <code>/etc/default/grub</code> and save the content in a <strong>new file <code>/etc/kernel/cmdline</code></strong>. The content - using a default Manjaro installation - would look like</p>
<pre><code>root=UUID=&lt;uuid&gt; rw quiet splash apparmor=1 security=apparmor udev.log_priority=3
</code></pre>
<p>When you created the file - create a new bundle using <strong>sbctl</strong>. </p>
<h3 id="define-bundle_1">Define Bundle</h3>
<p>A bundle is the set of files used to start your system.</p>
<p>To create a bundle definition you run <strong><code>sbctl bundle &lt;args&gt;</code></strong> providing the mountpoint of the $esp, paths to the files to bundle and full path to the unified efi loader.</p>
<ul>
<li><code>--amducode '/boot/amd-ucode.img'</code> includes ucode for AMD</li>
<li><code>--intelucode  '/boot/intel-ucode.img'</code>includes ucode for Intel</li>
</ul>
<p>Example for an AMD system</p>
<pre><code>sudo sbctl bundle --esp '/boot/efi' \
                  --amducode '/boot/amd-ucode.img' \
                  --cmdline '/etc/kernel/cmdline' \
                  --initramfs '/boot/initramfs-6.12-x86_64.img' \
                  --kernel-img '/boot/vmlinuz-6.12-x86_64' \
                  --save '/boot/efi/main.efi'
</code></pre>
<p>As can be deduced - it is fairly easy to create extra bundles with e.g. a fallback image - <strong>just don't do it</strong> (See Storage Consideration below).</p>
<h3 id="create-signing-keys_1">Create Signing Keys</h3>
<p>A key is required to sign the bundle - so create the key</p>
<pre><code>sudo sbctl create-keys
</code></pre>
<h3 id="generate-bundle-and-sign_1">Generate Bundle and Sign</h3>
<p>When you have created the keys - generate the bundle and sign</p>
<pre><code>sudo sbctl generate-bundles --sign
</code></pre>
<h3 id="configure-setup-mode_1">Configure Setup Mode</h3>
<p>Restart your system and enter the firmware setup</p>
<pre><code>systemctl reboot --firmware-setup
</code></pre>
<p>In the system firmware you need to locate the <strong>Secure Boot</strong> section, then configure Secure Boot for <strong>Setup Mode</strong>. </p>
<p>How you do this is specific for your firmware - you may need to experiment.</p>
<h3 id="enroll-keys_1">Enroll Keys</h3>
<p>When you are confident the system's Secure Boot is in Setup Mode, boot into your Manjaro system - and enroll your key into Secure Boot key storage, remember to include Microsoft keys</p>
<pre><code>sudo sbctl enroll-keys --microsoft
</code></pre>
<p>The command ensures the firmware Setup Mode is reverted to production mode. It is not automagically protected - for that you need to set an administrative password.</p>
<h2 id="firmware-boot-entry_1">Firmware boot entry</h2>
<p>To be able to use your firmware's boot override it is necesary to create a firmware boot entry. For our PoC the command look like this</p>
<p>To avoid confusing the default Manjaro entry; label the entry <strong>Manjaro Verified Boot</strong></p>
<pre><code>sudo efibootmgr  --loader main.efi --create --disk /dev/nvme0n1 --part 1 --label 'Manjaro Verified Boot' --unicode
</code></pre>
<h2 id="storage-consideration_1">Storage Consideration</h2>
<p>The $esp (efi system partition) with default Microsoft Windows 10 installation is 100M, and this is leaving little room to wiggle, as a single efi image takes 42M, thus leaving 29M remaining space.</p>
<pre><code class="language-text">[nix-n14xwu ~]# ls -l -h /boot/efi
total 42M
drwx------ 5 root root 1,0K 21 feb 12:59  EFI
drwx------ 2 root root 1,0K 21 feb 13:35  loader
-rwx------ 1 root root  42M 21 feb 12:42  main.efi
drwx------ 2 root root 1,0K 21 feb 11:37 'System Volume Information'
</code></pre>
<h2 id="maintenance_1">Maintenance</h2>
<p>The bundle is a static configuration - it will not change automagically - e.g. triggered by a hook.</p>
<p>The kernel maintenance within a release e.g. 6.12 is not an issue as the name has not changed.</p>
<p>When you decide to switch kernel e.g. from 6.12 to 6.14 - the name changes and you need to maintain your bundle.</p>
<h3 id="generate-new-bundle_1">Generate new Bundle</h3>
<p>This can be done by recreating your bundle configuration using <strong>sbctl</strong></p>
<pre><code>sudo sbctl bundle --esp '/boot/efi' \
                  --amducode '/boot/amd-ucode.img' \
                  --cmdline '/etc/kernel/cmdline' \
                  --initramfs '/boot/initramfs-6.14-x86_64.img' \
                  --kernel-img '/boot/vmlinuz-6.14-x86_64' \
                  --save '/boot/efi/main.efi'
</code></pre>
<h3 id="manually-update-bundle_1">Manually update bundle</h3>
<p>The bundle configuration is stored in <code>/var/lib/sbctl/bundles.json</code> so you can manually change the filenames but then you have no error checking if you misspell a filename - thus it is not recommended - instead use the bundle command.</p>
<h3 id="generate-bundle_1">Generate bundle</h3>
<p>Generate the bundle and sign it</p>
<pre><code>sudo sbctl generate-bundles --sign
</code></pre>
<h2 id="protect-your-firmware_1">Protect Your Firmware</h2>
<p>It is strongly suggested to lock your computers firmware with an administrative password - otherwise it is easy to circumvent the boot measures applied.</p>
<p>The firmware will now be enabled and your system may now be compliant with your corporate policies stating Secure Boot must be enabled.</p>
<p>Before you rejoice too much - ask your Corporate IT department.</p>
<p>Crossposted at <a href="https://forum.manjaro.org/t/enable-secure-boot-for-existing-manjaro-using-repo-only/174514">Enable Secure Boot For Existing Manjaro Usung Repo Only</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../scripts/script-usb-partion-format/" class="btn btn-neutral float-left" title="USB partition script"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../systemd/systemd-mount-unit-configuration/" class="btn btn-neutral float-right" title="systemd - mount units">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../scripts/script-usb-partion-format/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../systemd/systemd-mount-unit-configuration/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
